<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<link rel="stylesheet" href="style.css" type="text/css">
<meta content="text/html; charset=iso-8859-1" http-equiv="Content-Type">
<link rel="Start" href="index.html">
<link rel="previous" href="Cryptokit.Padding.html">
<link rel="next" href="Cryptokit.Cipher.html">
<link rel="Up" href="Cryptokit.html">
<link title="Index of types" rel=Appendix href="index_types.html">
<link title="Index of exceptions" rel=Appendix href="index_exceptions.html">
<link title="Index of values" rel=Appendix href="index_values.html">
<link title="Index of class methods" rel=Appendix href="index_methods.html">
<link title="Index of classes" rel=Appendix href="index_classes.html">
<link title="Index of class types" rel=Appendix href="index_class_types.html">
<link title="Index of modules" rel=Appendix href="index_modules.html">
<link title="Cryptokit" rel="Chapter" href="Cryptokit.html"><title>Cryptokit.Bn</title>
</head>
<body>
<div class="navbar"><a class="pre" href="Cryptokit.Padding.html" title="Cryptokit.Padding">Previous</a>
&nbsp;<a class="up" href="Cryptokit.html" title="Cryptokit">Up</a>
&nbsp;<a class="post" href="Cryptokit.Cipher.html" title="Cryptokit.Cipher">Next</a>
</div>
<h1>Module <a href="type_Cryptokit.Bn.html">Cryptokit.Bn</a></h1>
<pre><span class="keyword">module</span> Bn: <code class="code">sig</code> <a href="Cryptokit.Bn.html">..</a> <code class="code">end</code></pre><div class="info">
The <code class="code">Bn</code> module provides arithmetic on natural numbers.
Intermediate values are systematically wiped.<br>
</div>
<hr width="100%">
<pre><span id="TYPEnat"><span class="keyword">type</span> <code class="type"></code>nat</span> = <code class="type">Nat.nat</code> </pre>

<pre><span id="VALnat_of_bytes"><span class="keyword">val</span> nat_of_bytes</span> : <code class="type">string -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><pre><span id="VALbytes_of_nat"><span class="keyword">val</span> bytes_of_nat</span> : <code class="type">?numbits:int -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> string</code></pre><div class="info">
The optional argument <code class="code">numbits</code> defaults to the actual bit
    length length of the given <code class="code">nat</code>.<br>
</div>
<pre><span id="VALcopy"><span class="keyword">val</span> copy</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><pre><span id="VALwipe_nat"><span class="keyword">val</span> wipe_nat</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> unit</code></pre><pre><span id="VALwipe_string"><span class="keyword">val</span> wipe_string</span> : <code class="type">string -> unit</code></pre><pre><span id="VALzero"><span class="keyword">val</span> zero</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><pre><span id="VALone"><span class="keyword">val</span> one</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><pre><span id="VALcompare"><span class="keyword">val</span> compare</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> int</code></pre><pre><span id="VALnum_digits"><span class="keyword">val</span> num_digits</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> int</code></pre><pre><span id="VALnum_bits"><span class="keyword">val</span> num_bits</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> int</code></pre><pre><span id="VALadd"><span class="keyword">val</span> add</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><pre><span id="VALsub"><span class="keyword">val</span> sub</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><pre><span id="VALsub_mod"><span class="keyword">val</span> sub_mod</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><pre><span id="VALmult"><span class="keyword">val</span> mult</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><pre><span id="VALmult_add"><span class="keyword">val</span> mult_add</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><div class="info">
<code class="code">mult_add a b c</code> computes <code class="code">a*b + c</code>.<br>
</div>
<pre><span id="VALmod_"><span class="keyword">val</span> mod_</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><div class="info">
<code class="code">mod_ a b</code> computes <code class="code">a mod b</code>.<br>
</div>
<pre><span id="VALquo_mod"><span class="keyword">val</span> quo_mod</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> * <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><div class="info">
<code class="code">quo_mod a b</code> divides <code class="code">a</code> by <code class="code">b</code>, returning <code class="code">q, m</code> satisfying
    <code class="code">a = b*q + m</code>.<br>
</div>
<pre><span id="VALrelative_prime"><span class="keyword">val</span> relative_prime</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> bool</code></pre><div class="info">
<code class="code">relative_prime a b</code> returns true if <code class="code">gcd(a,b) = 1</code>.<br>
</div>
<pre><span id="VALmod_power"><span class="keyword">val</span> mod_power</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><div class="info">
<code class="code">mod_power a b n</code> computes <code class="code">a^b mod n</code> assuming <code class="code">a &lt; n</code>.<br>
</div>
<pre><span id="VALmod_power_CRT"><span class="keyword">val</span> mod_power_CRT</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -><br>       <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -><br>       <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -><br>       <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><div class="info">
<code class="code">mod_power_CRT a p q db dq qinv</code> computes <code class="code">a^d mod pq</code> where
        <code class="code">d</code> is defined by <code class="code">dp = d mod (p-1)</code> and <code class="code">dq = d mod (q-1)</code>
        and <code class="code">qinv</code> is <code class="code">q^-1 mod p</code>.<br>
</div>
<pre><span id="EXCEPTIONNot_invertible"><span class="keyword">exception</span> Not_invertible</span></pre>
<pre><span id="VALmod_inv"><span class="keyword">val</span> mod_inv</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><div class="info">
Modular inverse. <code class="code">mod_inv a n</code> returns <code class="code">b</code> such that <code class="code">ab ≡ 1
    mod n</code> ⇔ <code class="code">b ≡ a⁻¹ mod n</code> assuming <code class="code">a &lt; n</code>. It raises
    Not_invertible if no such <code class="code">b</code> exists (i.e., <code class="code">gcd(a,n) ≠ 1</code>).<br>
</div>
<pre><span id="VALrandom_nat"><span class="keyword">val</span> random_nat</span> : <code class="type">?rng:<a href="Cryptokit.Random.rng-c.html">Cryptokit.Random.rng</a> -> ?lowbits:int -> int -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><div class="info">
<code class="code">random_nat numbits</code> picks a random <code class="code">n</code> satisfying
    	<code class="code">2^{numbits-1} &lt; n &lt; 2^{numbits}</code>
    and return <code class="code">n | lowbits</code>. The optional <code class="code">rng</code> specifies a source of
    randomness; it defaults to <a href="Cryptokit.Random.html#VALsecure_rng"><code class="code">Cryptokit.Random.secure_rng</code></a>. The
    optional <code class="code">lowbits</code> defaults to zero.<br>
</div>
<pre><span id="TYPEprimekind"><span class="keyword">type</span> <code class="type"></code>primekind</span> </pre>

<pre><span id="VALany"><span class="keyword">val</span> any</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEprimekind">primekind</a></code></pre><pre><span id="VALsafe"><span class="keyword">val</span> safe</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEprimekind">primekind</a></code></pre><div class="info">
A safe prime <code class="code">p</code> has the form <code class="code">2p' +1</code> for <code class="code">p'</code> prime.<br>
</div>
<pre><span id="VALsg_of_safe"><span class="keyword">val</span> sg_of_safe</span> : <code class="type"><a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><div class="info">
Maps <code class="code">2p+1</code> to <code class="code">p</code>.<br>
</div>
<pre><span id="VALis_probably_prime"><span class="keyword">val</span> is_probably_prime</span> : <code class="type">?kind:<a href="Cryptokit.Bn.html#TYPEprimekind">primekind</a> -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a> -> bool</code></pre><div class="info">
Probabilistic primality test. If <code class="code">is_probably_prime ~kind:any
    p</code> returns false, then <code class="code">p</code> is composite. If <code class="code">is_probably_prime
    ~kind:safe p</code> returns false, then <code class="code">p</code> is not a safe prime. The
    optional <code class="code">kind</code> argument defaults to <a href="Cryptokit.Bn.html#VALany"><code class="code">Cryptokit.Bn.any</code></a>.<br>
</div>
<pre><span id="VALrandom_prime"><span class="keyword">val</span> random_prime</span> : <code class="type">?rng:<a href="Cryptokit.Random.rng-c.html">Cryptokit.Random.rng</a> -><br>       ?kind:<a href="Cryptokit.Bn.html#TYPEprimekind">primekind</a> -> int -> <a href="Cryptokit.Bn.html#TYPEnat">nat</a></code></pre><div class="info">
<code class="code">random_prime numbits</code> picks a random, odd prime <code class="code">p</code>
    satisfying
	<code class="code">2^{numbits-1} &lt; p &lt; 2^{numbits}.</code>
    The optional <code class="code">kind</code> argument further restricts <code class="code">p</code>; it defaults to
    <a href="Cryptokit.Bn.html#VALany"><code class="code">Cryptokit.Bn.any</code></a>.<br>
</div>
</body></html>